<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 18 Empirical p-values | Solutions for Probability and Statistics for Scientists and Engineers</title>
<meta name="author" content="Matthew Davis">
<meta name="author" content="Brianna Hitt">
<meta name="author" content="Kenneth Horton">
<meta name="author" content="Bradley Warner">
<meta name="description" content="18.1 Objective Conduct all four steps of a hypothesis test using probability models.  18.2 Homework  18.2.1 Problem 1 Repeat the analysis of the yawning data from last lesson but this time use the...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 18 Empirical p-values | Solutions for Probability and Statistics for Scientists and Engineers">
<meta property="og:type" content="book">
<meta property="og:image" content="/figures/SolutionCoverPSSE.png">
<meta property="og:description" content="18.1 Objective Conduct all four steps of a hypothesis test using probability models.  18.2 Homework  18.2.1 Problem 1 Repeat the analysis of the yawning data from last lesson but this time use the...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 18 Empirical p-values | Solutions for Probability and Statistics for Scientists and Engineers">
<meta name="twitter:description" content="18.1 Objective Conduct all four steps of a hypothesis test using probability models.  18.2 Homework  18.2.1 Problem 1 Repeat the analysis of the yawning data from last lesson but this time use the...">
<meta name="twitter:image" content="/figures/SolutionCoverPSSE.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Solutions for Probability and Statistics for Scientists and Engineers</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li class="book-part">Descriptive Statistical Modeling</li>
<li><a class="" href="CS1.html"><span class="header-section-number">1</span> Case Study</a></li>
<li><a class="" href="DB.html"><span class="header-section-number">2</span> Data Basics</a></li>
<li><a class="" href="ODCP.html"><span class="header-section-number">3</span> Overview of Data Collection Principles</a></li>
<li><a class="" href="STUDY.html"><span class="header-section-number">4</span> Studies</a></li>
<li><a class="" href="NUMDATA.html"><span class="header-section-number">5</span> Numerical Data</a></li>
<li><a class="" href="CATDATA.html"><span class="header-section-number">6</span> Categorical Data</a></li>
<li class="book-part">Probability Modeling</li>
<li><a class="" href="CS2.html"><span class="header-section-number">7</span> Case Study</a></li>
<li><a class="" href="PROBRULES.html"><span class="header-section-number">8</span> Probability Rules</a></li>
<li><a class="" href="CONDPROB.html"><span class="header-section-number">9</span> Conditional Probability</a></li>
<li><a class="" href="RANDVAR.html"><span class="header-section-number">10</span> Random Variables</a></li>
<li><a class="" href="CONRANDVAR.html"><span class="header-section-number">11</span> Continuous Random Variables</a></li>
<li><a class="" href="DISCRETENAMED.html"><span class="header-section-number">12</span> Named Discrete Distributions</a></li>
<li><a class="" href="CONTNNAMED.html"><span class="header-section-number">13</span> Named Continuous Distributions</a></li>
<li><a class="" href="MULTIDISTS.html"><span class="header-section-number">14</span> Multivariate Distributions</a></li>
<li><a class="" href="EST.html"><span class="header-section-number">15</span> Estimation Methods</a></li>
<li class="book-part">Statistical Modeling</li>
<li><a class="" href="CS3.html"><span class="header-section-number">16</span> Case Study</a></li>
<li><a class="" href="HYPOTEST.html"><span class="header-section-number">17</span> Hypothesis Testing</a></li>
<li><a class="active" href="PVALUES.html"><span class="header-section-number">18</span> Empirical p-values</a></li>
<li><a class="" href="CLT.html"><span class="header-section-number">19</span> Central Limit Theorem</a></li>
<li><a class="" href="CI.html"><span class="header-section-number">20</span> Confidence Intervals</a></li>
<li><a class="" href="BOOT.html"><span class="header-section-number">21</span> Bootstrap</a></li>
<li><a class="" href="ADDTESTS.html"><span class="header-section-number">22</span> Additional Hypothesis Tests</a></li>
<li class="book-part">Predictive Statistical Modeling</li>
<li><a class="" href="CS4.html"><span class="header-section-number">23</span> Case Study</a></li>
<li><a class="" href="LRBASICS.html"><span class="header-section-number">24</span> Linear Regression Basics</a></li>
<li><a class="" href="LRINF.html"><span class="header-section-number">25</span> Linear Regression Inference</a></li>
<li><a class="" href="LRDIAG.html"><span class="header-section-number">26</span> Regression Diagnostics</a></li>
<li><a class="" href="LRSIM.html"><span class="header-section-number">27</span> Simulation Based Linear Regression</a></li>
<li><a class="" href="LRMULTI.html"><span class="header-section-number">28</span> Multiple Linear Regression</a></li>
<li><a class="" href="LOGREG.html"><span class="header-section-number">29</span> Logistic Regression</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="PVALUES" class="section level1" number="18">
<h1>
<span class="header-section-number">18</span> Empirical p-values<a class="anchor" aria-label="anchor" href="#PVALUES"><i class="fas fa-link"></i></a>
</h1>
<div id="objective" class="section level2" number="18.1">
<h2>
<span class="header-section-number">18.1</span> Objective<a class="anchor" aria-label="anchor" href="#objective"><i class="fas fa-link"></i></a>
</h2>
<p>Conduct all four steps of a hypothesis test using probability models.</p>
</div>
<div id="homework-17" class="section level2" number="18.2">
<h2>
<span class="header-section-number">18.2</span> Homework<a class="anchor" aria-label="anchor" href="#homework-17"><i class="fas fa-link"></i></a>
</h2>
<div id="problem-1-17" class="section level3" number="18.2.1">
<h3>
<span class="header-section-number">18.2.1</span> Problem 1<a class="anchor" aria-label="anchor" href="#problem-1-17"><i class="fas fa-link"></i></a>
</h3>
<p>Repeat the analysis of the yawning data from last lesson but this time use the hypergeometric distribution.</p>
<p>Is yawning contagious?</p>
<p>An experiment conducted by the <em>MythBusters</em>, a science entertainment TV program on the Discovery Channel, tested if a person can be subconsciously influenced into yawning if another person near them yawns. 50 people were randomly assigned to two groups: 34 to a group where a person near them yawned (treatment) and 16 to a group where there wasn’t a person yawning near them (control). The following table shows the results of this experiment.</p>
<p><span class="math display">\[
\begin{array}{ccc|cc|c} &amp; &amp; &amp;\textbf{Group} &amp;  &amp;
\\&amp; &amp;       &amp; Treatment     &amp; Control       &amp; Total \\
&amp;\hline \textbf{Result}     &amp; \textit{Yawn}     &amp; 10        &amp; 4         &amp; 14    \\
&amp; &amp; \textit{No Yawn}        &amp; 24        &amp; 12            &amp; 36\\
&amp;\hline &amp;Total              &amp; 34        &amp; 16            &amp; 50
\end{array} 
\]</span></p>
<p>The data is in the file “yawn.csv.”</p>
<ol style="list-style-type: lower-alpha">
<li>What are the hypotheses?</li>
</ol>
<p><span class="math inline">\(H_0\)</span>: Yawning is not contagious, someone in the group yawning does not impact the percentage of the group that yawns.<br><span class="math inline">\(H_A\)</span>: Yawning does have an impact, it is contagious. If someone yawns then you are more likely to yawn.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Calculate the observed statistic, pick a cell.</li>
</ol>
<div class="sourceCode" id="cb352"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">yawn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/yawn.csv"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb353"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">yawn</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 50
## Columns: 2
## $ group   &lt;chr&gt; "treatment", "treatment", "control", "treatment", "treatment",…
## $ outcome &lt;chr&gt; "no_yawn", "no_yawn", "no_yawn", "no_yawn", "no_yawn", "yawn",…</code></pre>
<div class="sourceCode" id="cb355"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/mosaicCore/man/inspect.html">inspect</a></span><span class="op">(</span><span class="va">yawn</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## categorical variables:  
##      name     class levels  n missing
## 1   group character      2 50       0
## 2 outcome character      2 50       0
##                                    distribution
## 1 treatment (68%), control (32%)               
## 2 no_yawn (72%), yawn (28%)</code></pre>
<div class="sourceCode" id="cb357"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/mosaicCore/man/tally.html">tally</a></span><span class="op">(</span><span class="op">~</span><span class="va">outcome</span><span class="op">+</span><span class="va">group</span>,data<span class="op">=</span><span class="va">yawn</span>,margins <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>##          group
## outcome   control treatment Total
##   no_yawn      12        24    36
##   yawn          4        10    14
##   Total        16        34    50</code></pre>
<p>The random variable is the number of control patients that yawned from a population of 16 control patients, 34 treatment patients, where a total of 14 yawned.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Find the p-value using the hypergeometric distribution.</li>
</ol>
<p>In this case we want to find <span class="math inline">\(\mbox{P}(X \leq 4)\)</span> and double it since it is a two-sided test.</p>
<div class="sourceCode" id="cb359"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Hypergeometric.html">phyper</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">16</span>,<span class="fl">34</span>,<span class="fl">14</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.5127818</code></pre>
<p>Doubling this will take us above 1, which is not valid. You might have seen this when we did the randomization test for this problem in a previous lesson. Again, since the hypergeometric is not symmetrical, we can’t just double the p-value from the one-sided test. We could simply report the result as <span class="math inline">\(\approx 1\)</span>. If we look at a plot of the pmf, see the figure, you see that <span class="math inline">\(X=4\)</span> is the highest probability outcome. Thus the p-value is 1 if we sum all the values less than or equal to <span class="math inline">\(P(X=4)\)</span>.</p>
<div class="sourceCode" id="cb361"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gf_dist</span><span class="op">(</span><span class="st">"hyper"</span>,m<span class="op">=</span><span class="fl">16</span>,n<span class="op">=</span><span class="fl">34</span>,k<span class="op">=</span><span class="fl">14</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gf_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Hypergeometric.html">dhyper</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">16</span>,<span class="fl">34</span>,<span class="fl">14</span><span class="op">)</span>,color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gf_labs</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Hypergeometric pmf"</span>,
          subtitle<span class="op">=</span><span class="st">"Red line is P(X=4)"</span>,
          y<span class="op">=</span><span class="st">"Probability"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gf_theme</span><span class="op">(</span><span class="va">theme_classic</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: geom_hline(): Ignoring `mapping` because `yintercept` was provided.</code></pre>
<div class="inline-figure"><img src="20-Empirical-p-values-Solutions_files/figure-html/unnamed-chunk-6-1.png" width="672"></div>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/mosaicCore/man/tally.html">tally</a></span><span class="op">(</span><span class="op">~</span><span class="va">group</span><span class="op">+</span><span class="va">outcome</span>,data<span class="op">=</span><span class="va">yawn</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Fisher's Exact Test for Count Data
## 
## data:  tally(~group + outcome, data = yawn)
## p-value = 1
## alternative hypothesis: true odds ratio is not equal to 1
## 95 percent confidence interval:
##  0.2790902 6.5930656
## sample estimates:
## odds ratio 
##   1.244531</code></pre>
<div class="sourceCode" id="cb365"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">temp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Hypergeometric.html">dhyper</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">14</span>,<span class="fl">16</span>,<span class="fl">34</span>,<span class="fl">14</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">sum</a></span><span class="op">(</span><span class="va">temp</span><span class="op">[</span><span class="va">temp</span><span class="op">&lt;=</span><span class="fu"><a href="https://rdrr.io/r/stats/Hypergeometric.html">dhyper</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">16</span>,<span class="fl">34</span>,<span class="fl">14</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li>Plot the the sampling distribution.</li>
</ol>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gf_dist</span><span class="op">(</span><span class="st">"hyper"</span>,m<span class="op">=</span><span class="fl">16</span>,n<span class="op">=</span><span class="fl">34</span>,k<span class="op">=</span><span class="fl">14</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gf_vline</span><span class="op">(</span>xintercept <span class="op">=</span><span class="fl">4</span>,color<span class="op">=</span><span class="st">"red"</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gf_theme</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gf_labs</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Hypergeometric pmf"</span>,
          subtitle<span class="op">=</span><span class="st">"Red line is X=4"</span>,
          y<span class="op">=</span><span class="st">"Probability"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="20-Empirical-p-values-Solutions_files/figure-html/unnamed-chunk-9-1.png" width="672"></div>
<ol start="5" style="list-style-type: lower-alpha">
<li>Determine the conclusion of the hypothesis test.</li>
</ol>
<p>Since p-value, 1, is high, larger than 0.05, we fail to reject the null hypothesis of yawning is not contagious. The data do not provide convincing evidence that people are more likely to yawn if a person near them yawns.</p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Compare your results with the randomization test.</li>
</ol>
<p>This result is essentially the same as the randomization test.</p>
</div>
<div id="problem-2-17" class="section level3" number="18.2.2">
<h3>
<span class="header-section-number">18.2.2</span> Problem 2<a class="anchor" aria-label="anchor" href="#problem-2-17"><i class="fas fa-link"></i></a>
</h3>
<p>Repeat the golf ball example using a different test statistic.</p>
<p>Use a level of significance of 0.05.</p>
<ol style="list-style-type: lower-alpha">
<li>State the null and alternative hypotheses.</li>
</ol>
<p>We think that the numbers are not all equally likely. The question of one-sided versus two-sided is not relevant in this test, you will see this when we write the hypotheses.</p>
<p><span class="math inline">\(H_0\)</span>: All of the numbers are equally likely.<span class="math inline">\(\pi_1 = \pi_2 = \pi_3 = \pi_4\)</span> or <span class="math inline">\(\pi_1 = \frac{1}{4}, \pi_2 =\frac{1}{4}, \pi_3 =\frac{1}{4}, \pi_4 =\frac{1}{4}\)</span><br><span class="math inline">\(H_A\)</span>: The is some other distribution of percentages in the population. At least one population proportion is not <span class="math inline">\(\frac{1}{4}\)</span>.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Compute a test statistic.</li>
</ol>
<div class="sourceCode" id="cb368"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">golf_balls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/golf_balls.csv"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/mosaicCore/man/inspect.html">inspect</a></span><span class="op">(</span><span class="va">golf_balls</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## quantitative variables:  
##        name   class min Q1 median Q3 max     mean       sd   n missing
## ...1 number numeric   1  1      2  3   4 2.366255 1.107432 486       0</code></pre>
<div class="sourceCode" id="cb371"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/mosaicCore/man/tally.html">tally</a></span><span class="op">(</span><span class="op">~</span><span class="va">number</span>,data<span class="op">=</span><span class="va">golf_balls</span>,format <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span></code></pre></div>
<pre><code>## number
##         1         2         3         4 
## 0.2818930 0.2839506 0.2201646 0.2139918</code></pre>
<p>I will use the maximum deviation from the expected value</p>
<div class="sourceCode" id="cb373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/mosaicCore/man/tally.html">tally</a></span><span class="op">(</span><span class="op">~</span><span class="va">number</span>,data<span class="op">=</span><span class="va">golf_balls</span><span class="op">)</span> <span class="op">-</span><span class="fl">121.5</span><span class="op">)</span><span class="op">)</span>
<span class="va">obs</span></code></pre></div>
<pre><code>## [1] 17.5</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Determine the p-value.</li>
</ol>
<div class="sourceCode" id="cb375"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2517</span><span class="op">)</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/do.html">do</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/resample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,size<span class="op">=</span><span class="fl">486</span>,replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">121.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb376"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gf_histogram</span><span class="op">(</span><span class="op">~</span><span class="va">max</span>,fill<span class="op">=</span><span class="st">"cyan"</span>,color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gf_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">obs</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gf_labs</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Sampling Distribution of Maximum Deviation"</span>,
          subtitle<span class="op">=</span><span class="st">"Multinomial with equal probability"</span>,
          x<span class="op">=</span><span class="st">"Range"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gf_theme</span><span class="op">(</span><span class="va">theme_classic</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="20-Empirical-p-values-Solutions_files/figure-html/unnamed-chunk-15-1.png" width="672"></div>
<div class="sourceCode" id="cb377"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/mosaicCore/man/prop.html">prop1</a></span><span class="op">(</span><span class="op">~</span><span class="op">(</span><span class="va">max</span><span class="op">&gt;=</span><span class="va">obs</span><span class="op">)</span>,data<span class="op">=</span><span class="va">results</span><span class="op">)</span></code></pre></div>
<pre><code>## prop_TRUE 
## 0.2382762</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li>Draw a conclusion.</li>
</ol>
<p>Since this p-value is larger than 0.05, we do not reject the null hypothesis. That is, based on our data, we do not find statistically significant evidence against the claim that the number on the golf balls are equally likely.</p>
</div>
<div id="problem-3-12" class="section level3" number="18.2.3">
<h3>
<span class="header-section-number">18.2.3</span> Problem 3<a class="anchor" aria-label="anchor" href="#problem-3-12"><i class="fas fa-link"></i></a>
</h3>
<p>Body Temperature</p>
<p>Shoemaker<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;L. Shoemaker Allen (1996) What’s Normal? – Temperature, Gender, and Heart Rate, Journal of Statistics Education, 4:2&lt;/p&gt;"><sup>6</sup></a> cites a paper from the American Medical Association<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Mackowiak, P. A., Wasserman, S. S., and Levine, M. M. (1992), “A Critical Appraisal of 98.6 Degrees F, the Upper Limit of the Normal Body Temperature, and Other Legacies of Carl Reinhold August Wunderlich,” Journal of the American Medical Association, 268, 1578-1580.&lt;/p&gt;"><sup>7</sup></a> that questions conventional wisdom that the average body temperature of a human is 98.6. One of the main points of the original article – the traditional mean of 98.6 is, in essence, 100 years out of date. The authors cite problems with Wunderlich’s original methodology, diurnal fluctuations (up to 0.9 degrees F per day), and unreliable thermometers. The authors believe the average temperature is less than 98.6. Test the hypothesis.</p>
<ol style="list-style-type: lower-alpha">
<li>State the null and alternative hypotheses.</li>
</ol>
<p><span class="math inline">\(H_0\)</span>: The average body temperature is 98.6 <span class="math inline">\(\mu = 98.6\)</span><br><span class="math inline">\(H_A\)</span>: The average body temperature is less than 98.6. <span class="math inline">\(\mu &lt; 98.6\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>State the significance level that will be used.</li>
</ol>
<p>There is no reason to believe one type of error is more important than another.</p>
<p><span class="math inline">\(\alpha = 0.05\)</span></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Load the data from the file “temperature.csv” and generate summary statistics and a boxplot of the temperature data. We will not be using gender or heart rate for this problem.</li>
</ol>
<div class="sourceCode" id="cb379"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">temperature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/temperature.csv"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb380"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 130
## Columns: 3
## $ temperature &lt;dbl&gt; 96.3, 96.7, 96.9, 97.0, 97.1, 97.1, 97.1, 97.2, 97.3, 97.4…
## $ gender      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ hr          &lt;dbl&gt; 70, 71, 74, 80, 73, 75, 82, 64, 69, 70, 68, 72, 78, 70, 75…</code></pre>
<div class="sourceCode" id="cb382"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">favstats</a></span><span class="op">(</span><span class="op">~</span><span class="va">temperature</span>,data<span class="op">=</span><span class="va">temperature</span><span class="op">)</span></code></pre></div>
<pre><code>##   min   Q1 median   Q3   max     mean        sd   n missing
##  96.3 97.8   98.3 98.7 100.8 98.24923 0.7331832 130       0</code></pre>
<div class="sourceCode" id="cb384"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">temperature</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gf_boxplot</span><span class="op">(</span><span class="op">~</span><span class="va">temperature</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gf_theme</span><span class="op">(</span><span class="va">theme_classic</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="20-Empirical-p-values-Solutions_files/figure-html/unnamed-chunk-20-1.png" width="672"></div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Compute a test statistic. We are going to help you with this part. We cannot do a randomization test since we don’t have a second variable. It would be nice to use the mean as a test statistic but we don’t yet know the sampling distribution of the sample mean.</li>
</ol>
<p>Let’s get clever. If the distribution of the sample is symmetric, this is an assumption but look at the boxplot and summary statistics to determine if you are comfortable with it, then under the null hypothesis the observed values should be equally likely to either be greater or less than 98.6. Thus our test statistic is the number of cases that have a positive difference between the observed value and 98.6. This will be a binomial distribution with a probability of success of 0.5. You must also account for the possibility that there are observations of 98.6 in the data.</p>
<p>First let’s find out how many data points are equal to 98.6.</p>
<div class="sourceCode" id="cb385"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">temperature</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/mosaicCore/man/prop.html">count</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">==</span><span class="fl">98.6</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   `temperature == 98.6`     n
##   &lt;lgl&gt;                 &lt;int&gt;
## 1 FALSE                   120
## 2 TRUE                     10</code></pre>
<p>We have ten observations equal to 98.6, we will split this and make 5 have a positive difference and 5 have a negative difference.</p>
<p>Next determine that number of subjects that have a positive difference.</p>
<div class="sourceCode" id="cb387"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">temperature</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pos<span class="op">=</span><span class="op">(</span><span class="va">temperature</span><span class="op">-</span><span class="fl">98.6</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>num_greater<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/mosaic/man/aggregating.html">sum</a></span><span class="op">(</span><span class="va">pos</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   num_greater
##         &lt;int&gt;
## 1          39</code></pre>
<p>Therefore we have a total 44 subjects whose temperature was greater than 98.6 and 86 who had a temperature less than 98.6</p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Determine the p-value.</li>
</ol>
<p>Out of 130 subjects, 86 had a temperature less than 98.6 and 44 had a temperature greater. We can use either number to determine a p-value. If the null hypothesis were true, then the probability of 86 or more, this is more extreme under that alternative hypothesis, is</p>
<div class="sourceCode" id="cb389"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">85</span>,<span class="fl">130</span>,<span class="fl">.5</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.0001447744</code></pre>
<p>We could have also done 44 or less.</p>
<div class="sourceCode" id="cb391"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">44</span>,<span class="fl">130</span>,<span class="fl">.5</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.0001447744</code></pre>
<p>Our p-value is 0.00014.</p>
<p>Some other choices are to drop the 10 data points equal to 98.6. We should always be careful about deleting data. We could be extremely conservative and move all 10 points to greater than 98.6 and if we still reject, we will comfortable about our conclusion. Finally, we could randomly assign each point to one side or the other. You can check the p-values for each of these methods.</p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Draw a conclusion.</li>
</ol>
<p>Based on our data, if the true mean body temperature is 98.6, then the probability of having 86 or more subjects out of 130 with temperatures below this is 0.00014. This is too unlikely so we reject the hypothesis that the average body temperature is 98.6.</p>
<p>This is a clever way to test the claim. Make sure you understand how we solved. In the coming lessons we will show you alternative ways to attack the problem. We made it into a binomial random variable. The only assumption is independence and symmetry.</p>
<p>Notice that by descritizing this problem, we are taking information away. However, the p-value is still small.</p>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="HYPOTEST.html"><span class="header-section-number">17</span> Hypothesis Testing</a></div>
<div class="next"><a href="CLT.html"><span class="header-section-number">19</span> Central Limit Theorem</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#PVALUES"><span class="header-section-number">18</span> Empirical p-values</a></li>
<li><a class="nav-link" href="#objective"><span class="header-section-number">18.1</span> Objective</a></li>
<li>
<a class="nav-link" href="#homework-17"><span class="header-section-number">18.2</span> Homework</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#problem-1-17"><span class="header-section-number">18.2.1</span> Problem 1</a></li>
<li><a class="nav-link" href="#problem-2-17"><span class="header-section-number">18.2.2</span> Problem 2</a></li>
<li><a class="nav-link" href="#problem-3-12"><span class="header-section-number">18.2.3</span> Problem 3</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Solutions for Probability and Statistics for Scientists and Engineers</strong>" was written by Matthew Davis, Brianna Hitt, Kenneth Horton, Bradley Warner. It was last built on 2022-01-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
